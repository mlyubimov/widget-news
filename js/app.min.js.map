{"version":3,"sources":["widget.js"],"names":["ul","document","createElement","className","minList","minListContainer","btnAdd","type","ariaLabel","btnAll","btnAllContainer","appendChild","items","btnClose","widget","id","styleWidget","currentElem","listShow","tableShow","shown","data","storage","_this","this","fetch","then","res","json","init","block","querySelector","concat","classList","add","addStyle","i","length","li","minLi","insertAdjacentHTML","photo","title","link","author","Date","date","toLocaleDateString","toLocaleTimeString","slice","querySelectorAll","textContent","conjugationNumber","btnContainer","showNextNews","created","console","log","style","rel","href","head","quantity","numberNewsItemsAtTime","remained","count","display","marginBottom","_this2","addEventListener","event","target","closest","contains","status","remove","relatedTarget","parentNode","window","scrollTo","scrollIntoView"],"mappings":"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","sourcesContent":["// задаём глобальные переменные\r\nconst ul = document.createElement('ul');\r\nul.className = 'widget__list';\r\n\r\nconst minList = document.createElement('ul')\r\nminList.className = 'widget__list--min';\r\n\r\nconst minListContainer = document.createElement('div');\r\nminListContainer.className = 'widget__list--min-container';\r\n\r\nconst btnAdd = document.createElement('button');\r\nbtnAdd.type = 'button';\r\nbtnAdd.className = 'widget__btn widget__btn--add';\r\nbtnAdd.ariaLabel = 'Открыть больше новостей';\r\n\r\nconst btnAll = document.createElement('button');\r\nbtnAll.type = 'button';\r\nbtnAll.className = 'widget__btn widget__btn--all';\r\nbtnAll.ariaLabel = 'Открыть список всех новостей';\r\n\r\nconst btnAllContainer = document.createElement('div');\r\nbtnAllContainer.className = 'widget__btn--all-container';\r\nbtnAllContainer.appendChild(btnAll);\r\n\r\nconst btnClose = document.createElement('button');\r\nbtnClose.type = 'button';\r\nbtnClose.className = 'widget__btn widget__btn-close--min';\r\nbtnClose.ariaLabel = 'Закрыть список всех новостей';\r\n\r\nlet items;\r\n\r\n// задаём объект со всеми переменными, методами и отслеживаниями\r\nconst widget = {\r\n\tid: 'widget', //индентификатор виджета\r\n\tstyleWidget: 'css/widget.css', //путь до стиля\r\n\tcurrentElem: null, //для правильного отслеживания новедения на элемент списка\r\n\tlistShow: false, //для переключения функционала кнопки btnAdd\r\n\ttableShow: false, //для отображения минифицированного списка всех новостей\r\n\tshown: 0, //количество показанных новостей\r\n\tdata: [],\r\n\tstorage() { //хранилище новотсей\r\n\t\tfetch('https://mlyubimov.github.io/widget-news/storage/news.json')\r\n\t\t\t.then(res => res.json())\r\n\t\t\t.then(data => {\r\n\t\t\t\tthis.data = data; // добавление данных в data\r\n\t\t\t\tthis.init();  //инициализация виджета на страницу\r\n\t\t\t})\r\n\t},\r\n\tinit() {\r\n\t\tconst block = document.querySelector(`#${this.id}`);\r\n\t\tif (block) {\r\n\t\t\tblock.classList.add('widget');\r\n\t\t\tthis.addStyle();\r\n\r\n\t\t\tfor (let i = 0; i < this.data.length; i++) {\r\n\t\t\t\tconst li = document.createElement('li');\r\n\t\t\t\tli.className = 'widget__item';\r\n\r\n\t\t\t\tconst minLi = document.createElement('li');\r\n\t\t\t\tminLi.className = 'widget__item--min';\r\n\r\n\t\t\t\t//добавление структуры в каждый элемент списка\r\n\t\t\t\tli.insertAdjacentHTML('beforeEnd', `\r\n\t\t\t\t<div class=\"widget__photo widget__photo--not-read\" style=\"background-image: url(${this.data[i].photo})\"></div>\r\n\t\t\t\t<div class=\"widget__content-container\">\r\n\t\t\t\t\t<div class=\"widget__title-container\">\r\n\t\t\t\t\t\t<h2 class=\"widget__title\">${this.data[i].title}</h2>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<a class=\"widget__link\" href=\"${this.data[i].link}\" target=\"_blank\" aria-label=\"Перейти на подробное описание статьи «${this.data[i].title}» от автора ${this.data[i].author}\">Подбробнее</a>\r\n\t\t\t\t\t<div class=\"widget__footer-container\">\r\n\t\t\t\t\t\t<p class=\"widget__content widget__author\">${this.data[i].author}</p>\r\n\t\t\t\t\t\t<p class=\"widget__date\">${new Date(this.data[i].date).toLocaleDateString()} ${new Date(this.data[i].date).toLocaleTimeString().slice(0,-3)}</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>`);\r\n\r\n\t\t\t\t//добавление структуры в каждый элемент минифицированного списка\r\n\t\t\t\tminLi.insertAdjacentHTML('beforeEnd', `\r\n\t\t\t\t<h2 class=\"widget__title--min\">${this.data[i].title}</h2>\r\n\t\t\t\t<div class=\"widget__content--min\">\r\n\t\t\t\t\t<p class=\"widget__content--min widget__author--min\">${this.data[i].author}</p>\r\n\t\t\t\t\t<p class=\"widget__date--min\">${new Date(this.data[i].date).toLocaleDateString()} ${new Date(this.data[i].date).toLocaleTimeString().slice(0,-3)}</p>\r\n\t\t\t\t\t<a class=\"widget__link widget__link--min\" href=\"${this.data[i].link}\" target=\"_blank\" aria-label=\"Перейти на подробное описание статьи «${this.data[i].title}» от автора ${this.data[i].author}\">Подбробнее</a>\r\n\t\t\t\t</div>`);\r\n\t\t\t\t\r\n\t\t\t\tminList.appendChild(minLi);\r\n\t\t\t\tul.appendChild(li);\r\n\t\t\t}\r\n\r\n\t\t\titems = ul.querySelectorAll('.widget__item');\r\n\r\n\t\t\tbtnAdd.textContent = this.conjugationNumber();\r\n\r\n\t\t\tconst btnContainer = document.createElement('div');\r\n\t\t\tbtnContainer.className = 'widget__btn-container';\r\n\t\t\t\r\n\t\t\tbtnContainer.appendChild(btnAdd);\r\n\t\t\tbtnContainer.appendChild(btnAllContainer);\r\n\r\n\t\t\tbtnAllContainer.insertAdjacentHTML('beforeEnd', `<div class=\"widget__btn--all-news-count\">${this.data.length}</div>`);\r\n\r\n\t\t\tminListContainer.appendChild(minList);\r\n\t\t\tminListContainer.appendChild(btnClose);\r\n\r\n\t\t\tblock.appendChild(ul);\r\n\t\t\tblock.appendChild(btnContainer);\r\n\t\t\tblock.appendChild(minListContainer);\r\n\r\n\t\t\tthis.showNextNews();\r\n\t\t\tthis.created();\r\n\t\t} else {\r\n\t\t\tconsole.log(`Block id = \"${id}\" not found`);\r\n\t\t}\r\n\t},\r\n\taddStyle() { //функция, добавляющая стили виджета\r\n\t\tconst style = document.createElement('link'); \r\n\t\tstyle.rel = 'stylesheet'; \r\n\t\tstyle.type = 'text/css'; \r\n\t\tstyle.href = this.styleWidget; \r\n\t\tdocument.head.appendChild(style); \r\n\t},\r\n\tconjugationNumber() { //функция для спряжения текста\r\n\t\tlet quantity = this.numberNewsItemsAtTime()\r\n\t\tlet remained = items.length - this.shown;\r\n\r\n\t\tif (quantity === 1) {\r\n\t\t\treturn `Показать ещё ${quantity} новость из оставшихся ${remained}`;\r\n\t\t} else if (quantity === 2 || quantity === 3 || quantity === 4) {\r\n\t\t\treturn `Показать ещё ${quantity} новости из оставшихся ${remained}`;\r\n\t\t} else {\r\n\t\t\treturn `Показать ещё ${quantity} новостей из оставшихся ${remained}`;\r\n\t\t}\r\n\t},\r\n\tshowNextNews() { //функция для добавления новостей в список\r\n\t\tlet count = this.shown;\r\n\t\tlet quantity = this.numberNewsItemsAtTime();\r\n\r\n\t\tfor (let i = count; i < count + quantity; i++) {\r\n\t\t\tthis.shown = this.shown + 1;\r\n\t\t\titems[i].style.display = 'flex';\r\n\r\n\t\t\tif (i > 0) {\r\n\t\t\t\tif (items[i-1].style.marginBottom === '0px') {\r\n\t\t\t\t\titems[i-1].style.marginBottom = '20px';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (i === count + 2) {\r\n\t\t\t\titems[i].style.marginBottom = '0';\r\n\t\t\t}\r\n\t\t}\r\n\t\tbtnAdd.textContent = this.conjugationNumber();\r\n\r\n\t\tif (this.shown >= this.data.length) {\r\n\t\t\tthis.listShow = true;\r\n\t\t\tbtnAdd.textContent = 'Скрыть новости';\r\n\t\t}\r\n\t},\r\n\tnumberNewsItemsAtTime() { //функция для количества отображения за одно нажатие и оставшееся количество в конце списка\r\n\t\tif (this.data.length - this.shown > 3) { //количество всех новостей - количество показанных\r\n\t\t\treturn 3;\r\n\t\t} else {\r\n\t\t\treturn this.data.length - this.shown;\r\n\t\t}\r\n\t},\r\n\tcreated() {\r\n\t\tul.addEventListener('mouseover', event => {\r\n\t\t\t// перед тем, как войти на следующий элемент, курсор всегда покидает предыдущий\r\n\t\t\t// если currentElem есть, то мы ещё не ушли с предыдущего <li>,\r\n\t\t\t// это переход внутри - игнорируем такое событие\r\n\t\t\tif (this.currentElem) return;\r\n\t\t\r\n\t\t\tconst target = event.target.closest('li');\r\n\t\t\r\n\t\t\t// переход не на <li> - игнорировать\r\n\t\t\tif (!target) return;\r\n\t\t\r\n\t\t\t// переход на <li>, но вне нашего списка (возможно при вложенных списках)\r\n\t\t\t// игнорировать\r\n\t\t\tif (!ul.contains(target)) return;\r\n\t\t\r\n\t\t\t// ура, мы зашли на новый <li> и сменили статус с «не прочитано» на прочитано\r\n\t\t\tconst status = target.querySelector('.widget__photo');\r\n\t\t\tstatus.classList.remove('widget__photo--not-read');\r\n\t\t\tstatus.classList.add('widget__photo--read');\r\n\t\t\r\n\t\t\tthis.currentElem = target;\r\n\t\t});\r\n\t\t\r\n\t\tul.addEventListener('mouseout', event => {\r\n\t\t\t// если мы вне <li>, то игнорируем уход мыши\r\n\t\t\t// это какой-то переход внутри таблицы, но вне <li>\r\n\t\t\tif (!this.currentElem) return;\r\n\t\t\r\n\t\t\t// мы покидаем элемент – но куда? Возможно, на потомка?\r\n\t\t\tlet relatedTarget = event.relatedTarget;\r\n\t\t\r\n\t\t\twhile (relatedTarget) {\r\n\t\t\t\t// поднимаемся по дереву элементов и проверяем – внутри ли мы currentElem или нет\r\n\t\t\t\t// если да, то это переход внутри элемента – игнорируем\r\n\t\t\t\tif (relatedTarget === this.currentElem) return;\r\n\t\t\t\r\n\t\t\t\trelatedTarget = relatedTarget.parentNode;\r\n\t\t\t}\r\n\t\t\r\n\t\t\t// мы действительно покинули элемент\r\n\t\t\tthis.currentElem = null;\r\n\t\t});\r\n\t\t\r\n\t\tbtnAdd.addEventListener('click', () => { //отслеживание клика на кнопку btnAdd для добавления или скрытия новостей\r\n\t\t\tif (this.listShow === false) { //если listShow = false, тогда выполни функцию\r\n\t\t\t\tul.classList.add('widget__list--scroll');\r\n\t\t\t\tthis.showNextNews();\r\n\t\t\r\n\t\t\t} else if (this.listShow === true) { //иначе скрой все новости\r\n\t\t\t\tul.classList.remove('widget__list--scroll');\r\n\t\t\t\tfor (let i = 3; i < this.data.length; i++) {\r\n\t\t\t\t\tthis.shown = 3;\r\n\t\t\t\t\titems[i].style.display = 'none';\r\n\t\t\t\t}\r\n\t\t\t\titems[2].style.marginBottom = '0';\r\n\t\t\r\n\t\t\t\tbtnAdd.textContent = this.conjugationNumber();\r\n\t\t\t\tthis.listShow = false;\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tbtnAll.addEventListener('click', () => { //отслеживание клика на кнопку btnAll для отображения минифицированного списка новостей\r\n\t\t\tif (this.tableShow === false) {\r\n\t\t\t\tminListContainer.classList.add('widget__list--min-container--show');\r\n\t\t\t\twindow.scrollTo(0, 0);\r\n\t\t\t\tthis.tableShow = true;\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tbtnClose.addEventListener('click', () => { //отслеживание клика на кнопку btnAll для скрытия минифицированного списка новостей\r\n\t\t\tif (this.tableShow === true) {\r\n\t\t\t\tminListContainer.classList.remove('widget__list--min-container--show');\r\n\t\t\t\tbtnAll.scrollIntoView();\r\n\t\t\t\tthis.tableShow = false;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n};\r\n\r\nwidget.storage(); // получение данных с сервера"],"file":"app.min.js"}