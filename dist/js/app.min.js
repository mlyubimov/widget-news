"use strict";var ul=document.createElement("ul");ul.className="widget__list";var minList=document.createElement("ul");minList.className="widget__list--min";var minListContainer=document.createElement("div");minListContainer.className="widget__list--min-container";var btnAdd=document.createElement("button");btnAdd.type="button",btnAdd.className="widget__btn widget__btn--add",btnAdd.ariaLabel="Открыть больше новостей";var btnAll=document.createElement("button");btnAll.type="button",btnAll.className="widget__btn widget__btn--all",btnAll.ariaLabel="Открыть список всех новостей";var btnAllContainer=document.createElement("div");btnAllContainer.className="widget__btn--all-container",btnAllContainer.appendChild(btnAll);var items,btnClose=document.createElement("button");btnClose.type="button",btnClose.className="widget__btn widget__btn-close--min",btnClose.ariaLabel="Закрыть список всех новостей";var widget={id:"widget",styleWidget:"css/widget.css",currentElem:null,listShow:!1,tableShow:!1,shown:0,data:[],storage:function(){var t=this;fetch("../storage/news.json").then(function(t){return t.json()}).then(function(e){t.data=e,t.init()})},init:function(){var t=document.querySelector("#".concat(this.id));if(t){t.classList.add("widget"),this.addStyle();for(var e=0;e<this.data.length;e++){var n=document.createElement("li");n.className="widget__item";var i=document.createElement("li");i.className="widget__item--min",n.insertAdjacentHTML("beforeEnd",'\n\t\t\t\t<div class="widget__photo widget__photo--not-read" style="background-image: url('.concat(this.data[e].photo,')"></div>\n\t\t\t\t<div class="widget__content-container">\n\t\t\t\t\t<div class="widget__title-container">\n\t\t\t\t\t\t<h2 class="widget__title">').concat(this.data[e].title,'</h2>\n\t\t\t\t\t</div>\n\t\t\t\t\t<a class="widget__link" href="').concat(this.data[e].link,'" target="_blank" aria-label="Перейти на подробное описание статьи «').concat(this.data[e].title,"» от автора ").concat(this.data[e].author,'">Подбробнее</a>\n\t\t\t\t\t<div class="widget__footer-container">\n\t\t\t\t\t\t<p class="widget__content widget__author">').concat(this.data[e].author,'</p>\n\t\t\t\t\t\t<p class="widget__date">').concat(new Date(this.data[e].date).toLocaleDateString()," ").concat(new Date(this.data[e].date).toLocaleTimeString().slice(0,-3),"</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>")),i.insertAdjacentHTML("beforeEnd",'\n\t\t\t\t<h2 class="widget__title--min">'.concat(this.data[e].title,'</h2>\n\t\t\t\t<div class="widget__content--min">\n\t\t\t\t\t<p class="widget__content--min widget__author--min">').concat(this.data[e].author,'</p>\n\t\t\t\t\t<p class="widget__date--min">').concat(new Date(this.data[e].date).toLocaleDateString()," ").concat(new Date(this.data[e].date).toLocaleTimeString().slice(0,-3),'</p>\n\t\t\t\t\t<a class="widget__link widget__link--min" href="').concat(this.data[e].link,'" target="_blank" aria-label="Перейти на подробное описание статьи «').concat(this.data[e].title,"» от автора ").concat(this.data[e].author,'">Подбробнее</a>\n\t\t\t\t</div>')),minList.appendChild(i),ul.appendChild(n)}items=ul.querySelectorAll(".widget__item"),btnAdd.textContent=this.conjugationNumber();var a=document.createElement("div");a.className="widget__btn-container",a.appendChild(btnAdd),a.appendChild(btnAllContainer),btnAllContainer.insertAdjacentHTML("beforeEnd",'<div class="widget__btn--all-news-count">'.concat(this.data.length,"</div>")),minListContainer.appendChild(minList),minListContainer.appendChild(btnClose),t.appendChild(ul),t.appendChild(a),t.appendChild(minListContainer),this.showNextNews(),this.created()}else console.log('Block id = "'.concat(id,'" not found'))},addStyle:function(){var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=this.styleWidget,document.head.appendChild(t)},conjugationNumber:function(){var t=this.numberNewsItemsAtTime(),e=items.length-this.shown;return 1===t?"Показать ещё ".concat(t," новость из оставшихся ").concat(e):2===t||3===t||4===t?"Показать ещё ".concat(t," новости из оставшихся ").concat(e):"Показать ещё ".concat(t," новостей из оставшихся ").concat(e)},showNextNews:function(){for(var t=this.shown,e=this.numberNewsItemsAtTime(),n=t;n<t+e;n++)this.shown=this.shown+1,items[n].style.display="flex",n>0&&"0px"===items[n-1].style.marginBottom&&(items[n-1].style.marginBottom="20px"),n===t+2&&(items[n].style.marginBottom="0");btnAdd.textContent=this.conjugationNumber(),this.shown>=this.data.length&&(this.listShow=!0,btnAdd.textContent="Скрыть новости")},numberNewsItemsAtTime:function(){return this.data.length-this.shown>3?3:this.data.length-this.shown},created:function(){var t=this;ul.addEventListener("mouseover",function(e){if(!t.currentElem){var n=e.target.closest("li");if(n&&ul.contains(n)){var i=n.querySelector(".widget__photo");i.classList.remove("widget__photo--not-read"),i.classList.add("widget__photo--read"),t.currentElem=n}}}),ul.addEventListener("mouseout",function(e){if(t.currentElem){for(var n=e.relatedTarget;n;){if(n===t.currentElem)return;n=n.parentNode}t.currentElem=null}}),btnAdd.addEventListener("click",function(){if(!1===t.listShow)ul.classList.add("widget__list--scroll"),t.showNextNews();else if(!0===t.listShow){ul.classList.remove("widget__list--scroll");for(var e=3;e<t.data.length;e++)t.shown=3,items[e].style.display="none";items[2].style.marginBottom="0",btnAdd.textContent=t.conjugationNumber(),t.listShow=!1}}),btnAll.addEventListener("click",function(){!1===t.tableShow&&(minListContainer.classList.add("widget__list--min-container--show"),window.scrollTo(0,0),t.tableShow=!0)}),btnClose.addEventListener("click",function(){!0===t.tableShow&&(minListContainer.classList.remove("widget__list--min-container--show"),btnAll.scrollIntoView(),t.tableShow=!1)})}};widget.storage();
//# sourceMappingURL=app.min.js.map
